<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libctld: libctld.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libctld
   </div>
   <div id="projectbrief">Parsing host names based on public suffix list (PSL)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">libctld.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;cstrlib.h&gt;</code><br />
<code>#include &lt;cdict.h&gt;</code><br />
<code>#include &lt;clist.h&gt;</code><br />
<code>#include &lt;<a class="el" href="libctld_8h_source.html">libctld.h</a>&gt;</code><br />
<code>#include &lt;idn2.h&gt;</code><br />
</div>
<p><a href="libctld_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:addf7412336aec2671fa895f182af95de" id="r_addf7412336aec2671fa895f182af95de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#addf7412336aec2671fa895f182af95de">ctld_add_custom_suffix</a> (<a class="el" href="structctld__ctx.html">ctld_ctx</a> *ctx, char *suffix)</td></tr>
<tr class="memdesc:addf7412336aec2671fa895f182af95de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds custom suffix to the public part of PSL.  <br /></td></tr>
<tr class="separator:addf7412336aec2671fa895f182af95de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449588d297191f5710e39a5da2dc94db" id="r_a449588d297191f5710e39a5da2dc94db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#a449588d297191f5710e39a5da2dc94db">ctld_result_free</a> (<a class="el" href="structctld__result.html">ctld_result</a> *res)</td></tr>
<tr class="memdesc:a449588d297191f5710e39a5da2dc94db"><td class="mdescLeft">&#160;</td><td class="mdescRight">free the memory used by <a class="el" href="structctld__result.html">ctld_result</a> structure  <br /></td></tr>
<tr class="separator:a449588d297191f5710e39a5da2dc94db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f4f8fbcd4bda77a4a887f66ca34887" id="r_a97f4f8fbcd4bda77a4a887f66ca34887"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#a97f4f8fbcd4bda77a4a887f66ca34887">ctld_free</a> (<a class="el" href="structctld__ctx.html">ctld_ctx</a> *ctx)</td></tr>
<tr class="memdesc:a97f4f8fbcd4bda77a4a887f66ca34887"><td class="mdescLeft">&#160;</td><td class="mdescRight">free the memory used by ctld context  <br /></td></tr>
<tr class="separator:a97f4f8fbcd4bda77a4a887f66ca34887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab0ed504d2c3760d54d34e0a594e9ba7" id="r_aab0ed504d2c3760d54d34e0a594e9ba7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structctld__ctx.html">ctld_ctx</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#aab0ed504d2c3760d54d34e0a594e9ba7">ctld_parse_string</a> (char *data)</td></tr>
<tr class="memdesc:aab0ed504d2c3760d54d34e0a594e9ba7"><td class="mdescLeft">&#160;</td><td class="mdescRight">parse the PSL data from a null-terminated memory.  <br /></td></tr>
<tr class="separator:aab0ed504d2c3760d54d34e0a594e9ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaf36e4f187515dac4ceb76ea880671f" id="r_abaf36e4f187515dac4ceb76ea880671f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structctld__ctx.html">ctld_ctx</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#abaf36e4f187515dac4ceb76ea880671f">ctld_parse_file</a> (char *filename)</td></tr>
<tr class="memdesc:abaf36e4f187515dac4ceb76ea880671f"><td class="mdescLeft">&#160;</td><td class="mdescRight">parse PSL data by passing the filename.  <br /></td></tr>
<tr class="separator:abaf36e4f187515dac4ceb76ea880671f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af186ce6e04b37dec4033558a5d24292c" id="r_af186ce6e04b37dec4033558a5d24292c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#af186ce6e04b37dec4033558a5d24292c">ctld_is_domain_valid</a> (char *domain)</td></tr>
<tr class="memdesc:af186ce6e04b37dec4033558a5d24292c"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if the domain name contains illegal character  <br /></td></tr>
<tr class="separator:af186ce6e04b37dec4033558a5d24292c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a3602e67a667b579da280cdceccffc" id="r_ad5a3602e67a667b579da280cdceccffc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structctld__result.html">ctld_result</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libctld_8c.html#ad5a3602e67a667b579da280cdceccffc">ctld_parse</a> (<a class="el" href="structctld__ctx.html">ctld_ctx</a> *ctx, char *domain, int use_private_suffix)</td></tr>
<tr class="memdesc:ad5a3602e67a667b579da280cdceccffc"><td class="mdescLeft">&#160;</td><td class="mdescRight">parse the passed domain name based on the PSL and returns the result structure.  <br /></td></tr>
<tr class="separator:ad5a3602e67a667b579da280cdceccffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="addf7412336aec2671fa895f182af95de" name="addf7412336aec2671fa895f182af95de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf7412336aec2671fa895f182af95de">&#9670;&#160;</a></span>ctld_add_custom_suffix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctld_add_custom_suffix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctld__ctx.html">ctld_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>suffix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds custom suffix to the public part of PSL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Context returned by <a class="el" href="libctld_8c.html#abaf36e4f187515dac4ceb76ea880671f" title="parse PSL data by passing the filename.">ctld_parse_file()</a> or <a class="el" href="libctld_8c.html#aab0ed504d2c3760d54d34e0a594e9ba7" title="parse the PSL data from a null-terminated memory.">ctld_parse_string()</a> </td></tr>
    <tr><td class="paramname">suffix</td><td>your new suffix to add to the suffix list</td></tr>
  </table>
  </dd>
</dl>
<p>Why you should add custom suffix to the list? Sometimes the suffix is not in the PSL list (at least not in the public part) but it has a separate WHOIS server. You may want to distinguish those suffixes and treat them like they are public suffixes. In this case, you can use this function to add whatever suffix you want.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success or other values on failure</dd></dl>
<p>Possible error values:</p><ul>
<li>1 if context or suffix is NULL or empty</li>
<li>2 if suffix already exists in the public part of PSL</li>
<li>3 if allocation function(malloc()) failed </li>
</ul>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00356">356</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="a97f4f8fbcd4bda77a4a887f66ca34887" name="a97f4f8fbcd4bda77a4a887f66ca34887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f4f8fbcd4bda77a4a887f66ca34887">&#9670;&#160;</a></span>ctld_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctld_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctld__ctx.html">ctld_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>free the memory used by ctld context </p>
<p>This should be called by users to free the allocated memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>the context created by <a class="el" href="libctld_8c.html#abaf36e4f187515dac4ceb76ea880671f" title="parse PSL data by passing the filename.">ctld_parse_file()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00403">403</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="af186ce6e04b37dec4033558a5d24292c" name="af186ce6e04b37dec4033558a5d24292c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af186ce6e04b37dec4033558a5d24292c">&#9670;&#160;</a></span>ctld_is_domain_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ctld_is_domain_valid </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>domain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if the domain name contains illegal character </p>
<p>One needs to be very careful to use this function. some companies have illegal characters like '_' in the subdomain part of the domain name. So only use this function if you know what you are doing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">domain</td><td>A pointer to a null-terminated string (domain name) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success and 0 on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00478">478</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="ad5a3602e67a667b579da280cdceccffc" name="ad5a3602e67a667b579da280cdceccffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5a3602e67a667b579da280cdceccffc">&#9670;&#160;</a></span>ctld_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structctld__result.html">ctld_result</a> * ctld_parse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctld__ctx.html">ctld_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_private_suffix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>parse the passed domain name based on the PSL and returns the result structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>context created by calling <a class="el" href="libctld_8c.html#abaf36e4f187515dac4ceb76ea880671f" title="parse PSL data by passing the filename.">ctld_parse_file()</a> or <a class="el" href="libctld_8c.html#aab0ed504d2c3760d54d34e0a594e9ba7" title="parse the PSL data from a null-terminated memory.">ctld_parse_string()</a> </td></tr>
    <tr><td class="paramname">domain</td><td>the domain name you want to parse </td></tr>
    <tr><td class="paramname">use_private_suffix</td><td>0 means do not use private part of the PSL and 1 means using the private part of the PSL.</td></tr>
  </table>
  </dd>
</dl>
<p>This is the main API of the library.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns an instance of <a class="el" href="structctld__result.html">ctld_result</a> on success and NULL on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00516">516</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="abaf36e4f187515dac4ceb76ea880671f" name="abaf36e4f187515dac4ceb76ea880671f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaf36e4f187515dac4ceb76ea880671f">&#9670;&#160;</a></span>ctld_parse_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structctld__ctx.html">ctld_ctx</a> * ctld_parse_file </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>parse PSL data by passing the filename. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A pointer to a null-terminated string contains the name of the file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the ctld context which can be used in <a class="el" href="libctld_8c.html#ad5a3602e67a667b579da280cdceccffc" title="parse the passed domain name based on the PSL and returns the result structure.">ctld_parse()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00448">448</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="aab0ed504d2c3760d54d34e0a594e9ba7" name="aab0ed504d2c3760d54d34e0a594e9ba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab0ed504d2c3760d54d34e0a594e9ba7">&#9670;&#160;</a></span>ctld_parse_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structctld__ctx.html">ctld_ctx</a> * ctld_parse_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>parse the PSL data from a null-terminated memory. </p>
<p>the memory should be free by users if it needs to be freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>A pointer to a null-terminated string containing PSL data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the ctld context which can be used in <a class="el" href="libctld_8c.html#ad5a3602e67a667b579da280cdceccffc" title="parse the passed domain name based on the PSL and returns the result structure.">ctld_parse()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00423">423</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
<a id="a449588d297191f5710e39a5da2dc94db" name="a449588d297191f5710e39a5da2dc94db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a449588d297191f5710e39a5da2dc94db">&#9670;&#160;</a></span>ctld_result_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctld_result_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctld__result.html">ctld_result</a> *&#160;</td>
          <td class="paramname"><em>res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>free the memory used by <a class="el" href="structctld__result.html">ctld_result</a> structure </p>
<p>This should be called by users to free the allocated memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res</td><td>the return result of the <a class="el" href="libctld_8c.html#ad5a3602e67a667b579da280cdceccffc" title="parse the passed domain name based on the PSL and returns the result structure.">ctld_parse()</a> API </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="libctld_8c_source.html#l00383">383</a> of file <a class="el" href="libctld_8c_source.html">libctld.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
